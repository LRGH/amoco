from amoco.system.core import CoreExec
from amoco.arch.sparc import cpu_v8 as cpu
from amoco.system.elf import *

# legal values for e_version (version):
with Consts("e_flags"):
    EF_CPU32 = 0x00810000
    EF_SPARCV9_MM = 3
    EF_SPARCV9_TSO = 0
    EF_SPARCV9_PSO = 1
    EF_SPARCV9_RMO = 2
    EF_SPARC_LEDATA = 0x800000  # little endian data
    EF_SPARC_EXT_MASK = 0xFFFF00
    EF_SPARC_32PLUS = 0x000100  # generic V8+ features
    EF_SPARC_SUN_US1 = 0x000200  # Sun UltraSPARC1 extensions
    EF_SPARC_HAL_R1 = 0x000400  # HAL R1 extensions
    EF_SPARC_SUN_US3 = 0x000800  # Sun UltraSPARCIII ex

with Consts("r_type"):
    R_SPARC_8 = 0x1
    R_SPARC_NONE = 0x0
    R_SPARC_TLS_LDM_ADD = 0x3E
    R_SPARC_GLOB_DAT = 0x14
    R_SPARC_GLOB_JMP = 0x2A
    R_SPARC_LOPLT10 = 0x1A
    R_SPARC_UA32 = 0x17
    R_SPARC_SIZE64 = 0x57
    R_SPARC_TLS_DTPOFF64 = 0x4D
    R_SPARC_HIPLT22 = 0x19
    R_SPARC_TLS_IE_LDX = 0x46
    R_SPARC_GNU_VTINHERIT = 0xFA
    R_SPARC_PCPLT22 = 0x1C
    R_SPARC_13 = 0xB
    R_SPARC_TLS_IE_ADD = 0x47
    R_SPARC_DISP8 = 0x4
    R_SPARC_TLS_DTPMOD64 = 0x4B
    R_SPARC_NUM = 0xFD
    R_SPARC_GOTDATA_HIX22 = 0x50
    R_SPARC_TLS_GD_HI22 = 0x38
    R_SPARC_REV32 = 0xFC
    R_SPARC_COPY = 0x13
    R_SPARC_6 = 0x2D
    R_SPARC_TLS_LDO_LOX10 = 0x41
    R_SPARC_TLS_LDO_HIX22 = 0x40
    R_SPARC_HH22 = 0x22
    R_SPARC_DISP16 = 0x5
    R_SPARC_PCPLT32 = 0x1B
    R_SPARC_TLS_LDM_CALL = 0x3F
    R_SPARC_TLS_TPOFF64 = 0x4F
    R_SPARC_H44 = 0x32
    R_SPARC_PC_HM10 = 0x26
    R_SPARC_TLS_TPOFF32 = 0x4E
    R_SPARC_PC10 = 0x10
    R_SPARC_GOT10 = 0xD
    R_SPARC_M44 = 0x33
    R_SPARC_PC22 = 0x11
    R_SPARC_HI22 = 0x9
    R_SPARC_LOX10 = 0x31
    R_SPARC_HM10 = 0x23
    R_SPARC_PLT32 = 0x18
    R_SPARC_HIX22 = 0x30
    R_SPARC_TLS_GD_CALL = 0x3B
    R_SPARC_TLS_IE_HI22 = 0x43
    R_SPARC_GNU_VTENTRY = 0xFB
    R_SPARC_LO10 = 0xC
    R_SPARC_LM22 = 0x24
    R_SPARC_L44 = 0x34
    R_SPARC_TLS_GD_LO10 = 0x39
    R_SPARC_GOT22 = 0xF
    R_SPARC_TLS_IE_LD = 0x45
    R_SPARC_GOT13 = 0xE
    R_SPARC_PC_LM22 = 0x27
    R_SPARC_TLS_LDM_HI22 = 0x3C
    R_SPARC_DISP64 = 0x2E
    R_SPARC_TLS_GD_ADD = 0x3A
    R_SPARC_JMP_IREL = 0xF8
    R_SPARC_TLS_LDO_ADD = 0x42
    R_SPARC_IRELATIVE = 0xF9
    R_SPARC_UA64 = 0x36
    R_SPARC_WDISP22 = 0x8
    R_SPARC_WDISP10 = 0x58
    R_SPARC_WPLT30 = 0x12
    R_SPARC_7 = 0x2B
    R_SPARC_WDISP19 = 0x29
    R_SPARC_TLS_DTPOFF32 = 0x4C
    R_SPARC_16 = 0x2
    R_SPARC_TLS_LE_HIX22 = 0x48
    R_SPARC_OLO10 = 0x21
    R_SPARC_TLS_LDM_LO10 = 0x3D
    R_SPARC_11 = 0x1F
    R_SPARC_22 = 0xA
    R_SPARC_JMP_SLOT = 0x15
    R_SPARC_PLT64 = 0x2F
    R_SPARC_SIZE32 = 0x56
    R_SPARC_WDISP30 = 0x7
    R_SPARC_GOTDATA_OP = 0x54
    R_SPARC_RELATIVE = 0x16
    R_SPARC_TLS_IE_LO10 = 0x44
    R_SPARC_PCPLT10 = 0x1D
    R_SPARC_H34 = 0x55
    R_SPARC_TLS_LE_LOX10 = 0x49
    R_SPARC_DISP32 = 0x6
    R_SPARC_UA16 = 0x37
    R_SPARC_GOTDATA_LOX10 = 0x51
    R_SPARC_GOTDATA_OP_LOX10 = 0x53
    R_SPARC_5 = 0x2C
    R_SPARC_PC_HH22 = 0x25
    R_SPARC_10 = 0x1E
    R_SPARC_REGISTER = 0x35
    R_SPARC_TLS_DTPMOD32 = 0x4A
    R_SPARC_WDISP16 = 0x28
    R_SPARC_64 = 0x20
    R_SPARC_GOTDATA_OP_HIX22 = 0x52
    R_SPARC_32 = 0x3
